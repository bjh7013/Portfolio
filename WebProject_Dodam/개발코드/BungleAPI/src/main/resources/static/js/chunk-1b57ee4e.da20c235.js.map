{"version":3,"sources":["webpack:///./src/components/AlphabetWriting.vue?c4f5","webpack:///./src/components/AlphabetWriting.vue?1527","webpack:///src/components/AlphabetWriting.vue","webpack:///./src/components/AlphabetWriting.vue?d597","webpack:///./src/components/AlphabetWriting.vue?29a4"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","ref","attrs","staticRenderFns","watch","mounted","pointSize","window","innerHeight","init","onload","component"],"mappings":"gHAAA,yBAAsd,EAAG,G,yCCAzd,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,mBAAmBC,YAAY,CAAC,cAAc,OAAO,SAAW,aAAa,CAACH,EAAG,SAAS,CAACI,IAAI,IAAIF,YAAY,eAAeC,YAAY,CAAC,SAAW,WAAW,eAAe,OAAO,cAAc,QAAQE,MAAM,CAAC,GAAK,YACrVC,EAAkB,G,mHCYtB,GACE,MAAF,WACE,KAFF,WAGA,OACA,iBACA,YACA,YACA,YACA,cACA,QACA,WACA,gBACA,aACA,gBACA,iBACA,aACA,gBACA,cACA,UACA,eACA,+EACA,2BAGE,QAAF,CACA,SADA,SACA,KACA,YACA,iEACA,gBAGA,yCACQ,KAAR,eAGA,sBAGA,QAdA,WAcA,WAEA,GADA,+BACA,gBAGA,GAFA,kBAEA,mCACA,kFACA,mBACU,IAAV,kCACU,EAAV,+BACA,iBACY,SAAZ,EACY,UAAZ,sCACA,sBAEA,4BAIA,qFACA,gBACA,mBAEA,CACA,WACA,gBACA,iFACA,qBACA,0BACA,6BACA,SACA,iBACA,qBAEA,OAGA,UAnDA,WAoDA,oBAEA,iBAtDA,WAuDA,6DAEA,+CACA,gDACA,2CACA,6CAEA,QA9DA,WA8DA,WACA,cAEA,QADA,mBAEA,WACA,sBACA,qBACA,kDAEA,sBACA,OACA,MAGA,yBACA,gBAEA,WACA,sBACA,4BAEA,sBACA,4BAEA,qBAGA,cAEA,QADA,mBAEA,WACA,qBACA,qBACA,kDAEA,sBACA,OACA,MAGA,MACA,gBAEA,WACA,sBACA,4BAEA,uBACA,4BAEA,qBAEA,8DACA,gCAEA,qBACA,mBACA,6DACA,qDACA,iCACA,kBACA,kDACA,oCACA,yBACA,wBACA,4BACA,+BACA,gCACA,2BAEA,+BAEA,8CACA,6CACA,kCACA,kCACA,kCACA,mCACA,oBAEA,8BACA,gBACA,iBACA,uBAIA,cArJA,WAwJA,IAFA,QACA,4BACA,kDACA,kEACA,4GAEA,wEACA,2BACA,uBACA,gCACA,SAEA,GAEA,OADA,MACA,IAEA,sEACA,mBAGA,KA1KA,WA2KA,2BACA,yBAEA,cA9KA,WA8KA,WACA,+BACA,kBACA,WAEA,EADA,wCACA,aAEA,UAGA,SACA,wCACA,QACA,gBACA,qBAIA,cACA,qBAEA,SACA,OAEA,EADA,wCACA,EAEA,KAGA,4CACA,IAIA,sBACA,SACA,MACA,MAEA,kBAEA,cACA,cACA,8DACA,cACA,8DAIA,mBACA,mBAUA,OAPA,cACA,oBACA,gBACA,gBACA,sBAEA,WARA,yBAaA,cACA,4BACA,wBACA,WAEA,MAQA,cAGA,IADA,SACA,mBAKA,IAJA,aACA,OACA,UACA,UACA,aACA,gBACA,YACA,QACA,IACA,MAIA,SAvBA,MA0BA,SA/QA,WA+QA,WACA,oBACA,4CACA,iCACA,qCACA,yCACA,0EACA,+BACA,oBAGA,0EACA,+BACA,kCACA,oCACA,oGACA,OACA,OACA,MACA,gBACA,kBAEA,gBACA,oBAGA,cACA,kBAEA,kBACA,kBAEA,WACA,0BACA,kCACA,sCACA,iBACA,aAGA,kBACA,iBACA,eAGA,MAEA,KA9TA,WA+TA,qBACA,4BACA,6DACA,oCACA,sCACA,wBACA,qBACA,iBAEA,cAxUA,WAyUA,wBACA,mBACA,8CACA,iBACA,QACA,WAEA,4BACA,iCACA,mDACA,yCAEA,GADA,gCACA,YACA,+BACA,mBAIA,YA3VA,WA4VA,yBAEA,SA9VA,WA+VA,yBAEA,SAjWA,WAkWA,0BAGEC,MAAF,CACA,mBACA,uBAGEC,QAlYF,WAmYA,kDACA,yBACA,oBAEA,mCADA,MACA,KAMA,MAGIX,KAAKY,UAAYC,OAAOC,YAAc,GAC1C,gCACMd,KAAKe,OAELF,OAAOG,OAAShB,KAAKe,KAE3B,sBCnayV,I,wBCQrVE,EAAY,eACd,EACAnB,EACAW,GACA,EACA,KACA,KACA,MAIa,aAAAQ,E","file":"js/chunk-1b57ee4e.da20c235.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlphabetWriting.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlphabetWriting.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"canvas-container\",staticStyle:{\"user-select\":\"none\",\"position\":\"relative\"}},[_c('canvas',{ref:\"c\",staticClass:\"lower-canvas\",staticStyle:{\"position\":\"relative\",\"touch-action\":\"none\",\"user-select\":\"none\"},attrs:{\"id\":\"c\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"canvas-container\" style=\"user-select: none; position:relative;\">\r\n      <canvas ref=\"c\" id=\"c\" style=\"position:relative; touch-action: none; user-select: none;\" class=\"lower-canvas\"></canvas>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import Axios from 'axios';\r\nimport {fabric} from 'fabric';\r\nimport Axios from 'axios';\r\n\r\nexport default {\r\n    props:['letter'],\r\n    data(){\r\n\t\t\treturn{\r\n\t\t\t\tstopAnimation:false,\r\n\t\t\t\tcanvas: null,\r\n\t\t\t\tscaleX: null,\r\n\t\t\t\tscaleY: null,\r\n\t\t\t\tisPressing: false,\r\n\t\t\t\tpath:[],\r\n\t\t\t\taniPath:[],\r\n\t\t\t\treadyAniPath : false,\r\n\t\t\t\tpointSize: 30,\r\n\t\t\t\tcanvasWidth : 800,\r\n\t\t\t\tcanvasHeight : 800,\r\n\t\t\t\tcurPathIdx : 0,\r\n\t\t\t\tlastPointIdx : -1,\r\n\t\t\t\tisComplete : false,\r\n\t\t\t\tisFail : false,\r\n\t\t\t\timageLoaded : false,\r\n\t\t\t\tcurveLetters: ['ㅇ','ㅎ', 'ㅈ', 'ㅊ', 'ㅉ','가','아','사','자','차','카','하','값','몫','H','F'],\r\n\t\t\t\tfaster:['ㅇ','ㅎ','아','하']\r\n\t\t\t}\r\n    },\r\n    methods:{\r\n\t\t\tvalidate(pathIdx, pointIdx){\r\n\t\t\t\tpointIdx = Number(pointIdx)\r\n\t\t\t\tif(pathIdx != this.curPathIdx || (pointIdx != this.lastPointIdx + 1 && pointIdx != this.lastPointIdx)){\r\n\t\t\t\t\tthis.isFail = true\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif(pointIdx == this.path[this.curPathIdx].length - 1){//해당 획의 핀포인트들을 다 방문한 경우\r\n                    this.isComplete = true    \r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.lastPointIdx = pointIdx\r\n\t\t\t\treturn\r\n\t\t\t},\r\n\t\t\tmouseUp(){\r\n\t\t\t\tthis.isPressing = this.isFail = false\r\n\t\t\t\tif(this.isComplete){\r\n\t\t\t\t\tthis.curPathIdx++\r\n\r\n\t\t\t\t\tif(this.curPathIdx == this.path.length){\r\n\t\t\t\t\t\tnew Audio(`${this.$store.getters.BACKEND_URL}/letter/finish.mp3`).play()\r\n\t\t\t\t\t\tthis.sendSuccess()\r\n                            var url= location.pathname.split(\"/\")[2];\r\n                            Axios.post(\"/koreandetail/submit\",{\r\n\t\t\t\t\t\t\t\t\"koreandetailNo\":url,\r\n                                \"correct\":true,\r\n                                \"studentNo\":this.$store.getters.userInfo.userNo,\r\n                            }).then((response)=>{\r\n\t\t\t\t\t\t\t\tresponse\r\n                            }).catch((err)=>{\r\n\t\t\t\t\t\t\t\terr\r\n                            })\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tnew Audio(`${this.$store.getters.BACKEND_URL}/letter/next_path.mp3`).play()\r\n\t\t\t\t\t\tthis.sendNext()\r\n\t\t\t\t\t\tthis.setPath()\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlet timerId = null\r\n\t\t\t\t\tthis.sendFail()\r\n\t\t\t\t\tnew Audio(`${this.$store.getters.BACKEND_URL}/letter/wrong.mp3`).play()\r\n\t\t\t\t\tthis.lastPointIdx = -1\r\n\t\t\t\t\ttimerId = setInterval(()=>{\r\n\t\t\t\t\t\tif(this.canvas._objects.length > 1){\r\n\t\t\t\t\t\t\tthis.undo()\r\n\t\t\t\t\t\t\tclearInterval(timerId)\r\n\t\t\t\t\t\t\tthis.showAnimation()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},100)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmouseDown(){\r\n\t\t\t\tthis.isPressing = true\r\n\t\t\t},\r\n\t\t\tsetEventHandlers(){\r\n\t\t\t\tlet canvasContainer = document.getElementsByClassName('canvas-container')[0]\r\n\t\t\t\t///////////////////////////////////////////////Bubling을 활용해 canvas와 div태그로부터 전파되는 이벤트 감지\r\n\t\t\t\tcanvasContainer.addEventListener('mousedown', this.mouseDown)\r\n\t\t\t\tcanvasContainer.addEventListener('touchstart', this.mouseDown)\r\n\t\t\t\tcanvasContainer.addEventListener('mouseup', this.mouseUp)\r\n\t\t\t\tcanvasContainer.addEventListener('touchend', this.mouseUp)\r\n\t\t\t},\r\n\t\t\tsetPath(){\r\n\t\t\t\tlet move = (e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tlet loc, target;\r\n\t\t\t\t\ttarget = e.target\r\n\t\t\t\t\tif(e.type == 'touchmove'){\r\n\t\t\t\t\t\tloc = e.targetTouches[0];\r\n\t\t\t\t\t\ttarget = document.elementFromPoint(loc.clientX, loc.clientY)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet id = target.id.split('-');\r\n\t\t\t\t\tlet i = id[1]\r\n\t\t\t\t\tif(!i){\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(this.isPressing && !this.isFail){\r\n\t\t\t\t\t\tthis.validate(pathIdx, i)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet nEvent = null\r\n\t\t\t\t\tif(e.type == 'mousemove'){\r\n\t\t\t\t\t\tnEvent = new MouseEvent(e.type, e)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(e.type == 'touchmove'){\r\n\t\t\t\t\t\tnEvent = new TouchEvent(e.type, e)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tupperCanvas.dispatchEvent(nEvent)\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet down  = (e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tlet loc, target;\r\n\t\t\t\t\ttarget = e.target\r\n\t\t\t\t\tif(e.type == 'toucdown'){\r\n\t\t\t\t\t\tloc = e.targetTouches[0];\r\n\t\t\t\t\t\ttarget = document.elementFromPoint(loc.clientX, loc.clientY)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet id = target.id.split('-')\r\n\t\t\t\t\tlet i = id[1]\r\n\t\t\t\t\tif(!i){\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(i == 0){\r\n\t\t\t\t\t\tthis.validate(pathIdx, i)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet nEvent = null\r\n\t\t\t\t\tif(e.type == 'mousedown'){\r\n\t\t\t\t\t\tnEvent = new MouseEvent(e.type, e)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(e.type == 'touchstart'){\r\n\t\t\t\t\t\tnEvent = new TouchEvent(e.type, e)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tupperCanvas.dispatchEvent(nEvent)\r\n\t\t\t\t};\r\n\t\t\t\tdocument.getElementsByClassName('point').forEach( (div) => {\r\n\t\t\t\t\tdiv.style.pointerEvents = 'none'\r\n\t\t\t\t})\r\n\t\t\t\tthis.lastPointIdx = -1\r\n\t\t\t\tthis.isComplete = false\r\n\t\t\t\tlet canvasContainer = document.getElementsByClassName('canvas-container')[0]\r\n\t\t\t\tlet upperCanvas = document.getElementsByClassName('upper-canvas')[0]\r\n\t\t\t\tlet color = ['red', 'blue', 'green', 'black']\r\n\t\t\t\tlet pathIdx = this.curPathIdx;\t\r\n\t\t\t\tthis.path[this.curPathIdx].forEach( (point, i) => {\r\n\t\t\t\t\tlet div = document.createElement('div')\r\n\t\t\t\t\tdiv.classList.add('point')\r\n\t\t\t\t\tdiv.id = this.curPathIdx + '-' + i\r\n\t\t\t\t\tdiv.style.position = 'absolute';\r\n\t\t\t\t\tdiv.style.width = this.pointSize + 'px'\r\n\t\t\t\t\tdiv.style.height = this.pointSize + 'px'\r\n\t\t\t\t\tdiv.style.cursor = 'crosshair'\r\n\t\t\t\t\t//////////////////////////////////////\r\n\t\t\t\t\tdiv.style.backgroundColor = color[i % 4]\r\n\t\t\t\t\t///////////////////////////////////////\r\n\t\t\t\t\tdiv.style.left =  point[0] * this.scaleX - (this.pointSize / 2) + 'px'\r\n\t\t\t\t\tdiv.style.top =  point[1] * this.scaleY - (this.pointSize / 2) + 'px'\t\t\r\n\t\t\t\t\tdiv.addEventListener('mousemove', move)\r\n\t\t\t\t\tdiv.addEventListener('touchmove', move)\r\n\t\t\t\t\tdiv.addEventListener('mousedown', down)\r\n\t\t\t\t\tdiv.addEventListener('touchstart', down)\r\n\t\t\t\t\tcanvasContainer.appendChild(div)\r\n\t\t\t\t} )\r\n\t\t\t\tlet timerId = setInterval(() => {\r\n\t\t\t\t\tif(this.imageLoaded){\r\n\t\t\t\t\t\tclearInterval(timerId)\r\n\t\t\t\t\t\tthis.showAnimation()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinitAnimation(){\r\n\t\t\t\tvar lastTime = 0;\r\n\t\t\t\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\r\n\t\t\t\tfor (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n\t\t\t\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n\t\t\t\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n\t\t\t\t}\r\n\t\t\t\tif (!window.requestAnimationFrame) window.requestAnimationFrame = function (callback) {\r\n\t\t\t\t\tvar currTime = new Date().getTime();\r\n\t\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n\t\t\t\t\tvar id = window.setTimeout(function () {\r\n\t\t\t\t\t\t\tcallback(currTime + timeToCall);\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttimeToCall);\r\n\t\t\t\t\tlastTime = currTime + timeToCall;\r\n\t\t\t\t\treturn id;\r\n\t\t\t\t};\r\n\t\t\t\tif (!window.cancelAnimationFrame) window.cancelAnimationFrame = function (id) {\r\n\t\t\t\t\tclearTimeout(id);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tundo(){\r\n\t\t\t\tthis.canvas._objects.pop()\r\n\t\t\t\tthis.canvas.renderAll()\r\n\t\t\t},\r\n\t\t\tshowAnimation(){\r\n\t\t\t\tvar ctx = this.canvas.getContext(\"2d\");\r\n\t\t\t\tctx.lineCap = \"round\";\t\r\n\t\t\t\tlet pathForAnimation = null\r\n\t\t\t\tif(this.curveLetters.includes(this.letter)){\r\n\t\t\t\t\t\tpathForAnimation = this.aniPath\r\n\t\t\t\t}else{\r\n\t\t\t\t\t\tpathForAnimation = this.path\r\n\t\t\t\t}\r\n\t\t\t\t// define the path to plot\r\n\t\t\t\tvar vertices = [];\r\n\t\t\t\tpathForAnimation[this.curPathIdx].forEach( (point) => {\r\n\t\t\t\t\tvertices.push({\r\n\t\t\t\t\t\tx : point[0] * this.scaleX,\r\n\t\t\t\t\t\ty : point[1] * this.scaleY\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t// set some style\r\n\t\t\t\tctx.lineWidth = 5;\r\n\t\t\t\tctx.strokeStyle = \"blue\";\r\n\t\t\t\t// calculate incremental points along the path\r\n\t\t\t\tvar frame = 10\r\n\t\t\t\tvar points = null\r\n\t\t\t\tif(this.curveLetters.includes(this.letter)){\r\n\t\t\t\t\tpoints = vertices\r\n\t\t\t\t}else{\r\n\t\t\t\t\tpoints = calcWaypoints(vertices);\r\n\t\t\t\t}\r\n\t\t\t\t// variable to hold how many frames have elapsed in the animation\r\n\t\t\t\tvar t = this.faster.includes(this.letter) ? 7 : 3;\r\n\t\t\t\tlet step = t;\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tfunction canvas_arrow(context, fromx, fromy, tox, toy) {\r\n\t\t\t\t\tvar headlen = 10; // length of head in pixels\r\n\t\t\t\t\tvar dx = tox - fromx;\r\n\t\t\t\t\tvar dy = toy - fromy;\r\n\r\n\t\t\t\t\tvar angle = Math.atan2(dy, dx);\r\n\t\t\t\t\t\r\n\t\t\t\t\tcontext.moveTo(fromx, fromy);\r\n\t\t\t\t\tcontext.lineTo(tox, toy);\r\n\t\t\t\t\tcontext.lineTo(tox - headlen * Math.cos(angle - Math.PI / 4), toy - headlen * Math.sin(angle - Math.PI / 4));\r\n\t\t\t\t\tcontext.moveTo(tox, toy);\r\n\t\t\t\t\tcontext.lineTo(tox - headlen * Math.cos(angle + Math.PI / 4), toy - headlen * Math.sin(angle + Math.PI / 4));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// extend the line from start to finish with animation\r\n\t\t\t\tlet animate = () => {\r\n\t\t\t\t\tif (t < points.length - 1) {\r\n\t\t\t\t\t\trequestAnimationFrame(animate);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tcanvas_arrow(ctx,points[points.length - 2].x,\r\n\t\t\t\t\t\t\t\t\t\tpoints[points.length - 2].y,\r\n\t\t\t\t\t\t\t\t\t\tpoints[points.length - 1].x, \r\n\t\t\t\t\t\t\t\t\t\tpoints[points.length - 1].y);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// draw a line segment from the last waypoint\r\n\t\t\t\t\t// to the current waypoint\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(points[t - step].x, points[t - step].y);\r\n\t\t\t\t\tctx.lineTo(points[t].x, points[t].y);\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t// increment \"t\" to get the next waypoint\r\n\t\t\t\t\tt += step;\r\n\t\t\t\t}\r\n\t\t\t\tanimate(points);\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t// calc waypoints traveling along vertices\r\n\t\t\t\tfunction calcWaypoints(vertices) {\r\n\t\t\t\t\t// var waypoints = [];\r\n\t\t\t\t\tvar waypoints = [];\r\n\t\t\t\t\tfor (var i = 1; i < vertices.length; i++) {\r\n\t\t\t\t\t\tvar pt0 = vertices[i - 1];\r\n\t\t\t\t\t\tvar pt1 = vertices[i];\r\n\t\t\t\t\t\tvar dx = pt1.x - pt0.x;\r\n\t\t\t\t\t\tvar dy = pt1.y - pt0.y;\r\n\t\t\t\t\t\tfor (var j = 0; j < frame; j++) {\r\n\t\t\t\t\t\t\tvar x = pt0.x + dx * j / frame;\r\n\t\t\t\t\t\t\tvar y = pt0.y + dy * j / frame;\r\n\t\t\t\t\t\t\twaypoints.push({\r\n\t\t\t\t\t\t\t\tx: x,\r\n\t\t\t\t\t\t\t\ty: y\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (waypoints);\r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t\tsetImage(){\r\n\t\t\t\tthis.canvas.clear()\r\n\t\t\t\tlet letter = this.$route.query.letter || this.letter\r\n\t\t\t\tlet uri = encodeURI(`letter/${letter}`)\r\n\t\t\t\tlet aniUri = encodeURI(`letter/ani_${letter}`)\r\n\t\t\t\tif(this.curveLetters.includes(this.letter)){\r\n\t\t\t\t\tAxios.get(`${this.$store.getters.BACKEND_URL}/${aniUri}.json`)\r\n\t\t\t\t\t.then(({data}) => {\r\n\t\t\t\t\t\tthis.aniPath = data.path\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tAxios.get(`${this.$store.getters.BACKEND_URL}/${uri}.json`)\r\n\t\t\t\t.then(({data})=>{\t\r\n\t\t\t\t\tthis.scaleX = this.canvasWidth / data.imgWidth\r\n\t\t\t\t\tthis.scaleY = this.canvasHeight / data.imgHeight\r\n\t\t\t\t\tfabric.Image.fromURL(`${this.$store.getters.BACKEND_URL}/${uri}.png`, (img) =>{\r\n\t\t\t\t\t\timg.set({\r\n\t\t\t\t\t\t\tleft:0,\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tscaleX: this.scaleX,\r\n\t\t\t\t\t\t\tscaleY: this.scaleY\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.canvas.add(img)\r\n\t\t\t\t\t\tthis.imageLoaded = true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.path = data.path\r\n\t\t\t\t\tthis.curPathIdx = 0;\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\talert('error')\r\n\t\t\t\t})\r\n\t\t\t\tlet timerId = null\r\n\t\t\t\ttimerId = setInterval(()=>{\r\n\t\t\t\t\tif(this.curveLetters.includes(this.letter)){\r\n\t\t\t\t\t\tif(this.path.length > 0 && this.aniPath.length > 0){\r\n\t\t\t\t\t\t\tclearInterval(timerId)\r\n\t\t\t\t\t\t\tthis.setPath()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(this.path.length > 0){          \r\n\t\t\t\t\t\t\tclearInterval(timerId)\r\n\t\t\t\t\t\t\tthis.setPath()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},200)\r\n\t\t\t},\r\n\t\t\tinit(){\r\n\t\t\t\tthis.prepareCanvas();\r\n\t\t\t\tthis.canvas = window.__canvas;\r\n\t\t\t\tlet container = document.getElementsByClassName('canvas-container')[0]\r\n\t\t\t\tcontainer.style.width = this.canvasWidth + 'px'\r\n\t\t\t\tcontainer.style.height = this.canvasHeight + 'px'\r\n\t\t\t\tthis.setEventHandlers();\r\n\t\t\t\tthis.initAnimation();\r\n\t\t\t\tthis.setImage()\r\n\t\t\t},\r\n\t\t\tprepareCanvas() {\r\n\t\t\t\tlet canvasHeight = this.canvasHeight\r\n\t\t\t\tlet canvasWidth = this.canvasWidth\r\n\t\t\t\tvar canvas = window.__canvas = new fabric.Canvas('c', {\r\n\t\t\t\t\tisDrawingMode: true,\r\n\t\t\t\t\twidth: canvasWidth,\r\n\t\t\t\t\theight: canvasHeight\r\n\t\t\t\t});\r\n\t\t\t\tcanvas.freeDrawingBrush.width = 10;\r\n\t\t\t\tcanvas.freeDrawingBrush.color = 'green'\r\n\t\t\t\tfabric.Object.prototype.transparentCorners = false;\r\n\t\t\t\tvar canvases = window.__canvases || window.canvases;\r\n\t\t\t\tcanvas && canvas.calcOffset && canvas.calcOffset();\r\n\t\t\t\tif (canvases && canvases.length) {\r\n\t\t\t\t\tfor (var i = 0, len = canvases.length; i < len; i++) {\r\n\t\t\t\t\t\tcanvases[i].calcOffset();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t},\r\n\t\tsendSuccess(){\r\n\t\t\tthis.$emit('success',1);\r\n\t\t},\r\n\t\tsendNext(){\r\n\t\t\tthis.$emit('success',2);\r\n\t\t},\r\n\t\tsendFail(){\r\n\t\t\tthis.$emit('success',3);\r\n\t\t}    \r\n  },\r\n  watch:{\r\n\t\taniPath: function(){\r\n\t\t\tthis.readyAniPath = true\r\n\t\t}\r\n  },\r\n  mounted(){\r\n\tthis.letter = this.$route.query.letter || this.letter\r\n\tvar winh = window.innerHeight;\r\n\tvar winw = window.innerWidth;\r\n\tif(winw < 600){\r\n\t\tthis.canvasWidth = this.canvasHeight = winw * 0.80;\r\n\t}\r\n\t// else if(winh>winw){\r\n\t// \t\tthis.canvasWidth = this.canvasHeight = winh * 0.58;\r\n\t// } \r\n\telse {\r\n\t\tthis.canvasWidth = this.canvasHeight = winh * 0.58;\r\n\t}\r\n\t\t\r\n    this.pointSize = window.innerHeight / 20;\r\n    if(document.readyState == 'complete'){\r\n      this.init()\r\n    }else{\r\n      window.onload = this.init\r\n\t}\r\n\tthis.$emit('speak')\r\n  },\r\n//   watch:{\r\n//       letter: function(){\r\n//           this.setImage();\r\n//       }\r\n//   }\r\n}\r\n</script>\r\n\r\n<style>\r\n.canvas-container{\r\n  margin: auto;\r\n  padding: auto;\r\n  display: flex;\r\n}\r\n.point{\r\n  opacity: 0;\r\n}\r\n\r\nlabel {\r\ndisplay: inline-block; width: 130px;\r\n}\r\n.info {\r\n  display: inline-block;\r\n  width: 25px;\r\n  background: #ffc;\r\n}\r\n#bd-wrapper {\r\n  min-width: 1500px;\r\n}\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlphabetWriting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlphabetWriting.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlphabetWriting.vue?vue&type=template&id=9bcaae3c&\"\nimport script from \"./AlphabetWriting.vue?vue&type=script&lang=js&\"\nexport * from \"./AlphabetWriting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AlphabetWriting.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}